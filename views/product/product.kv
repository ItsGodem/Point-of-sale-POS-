#: import Factory kivy.factory.Factory

<Product>:
    BoxLayout:
        orientation:'vertical'
        size_hint_x: .7
        spacing: dp(12)
        padding: [dp(14), 0]
        BoxLayout:
            spacing: dp(12)
            size_hint_y: None
            height: dp(128)
            AnchorLayout:
                anchor_x: 'left'
                padding: [dp(24), dp(3)]
                BackBox:    
                    bcolor: app.color_secondary_bg
                    radius: [self.height *.1]
                    size_hint_y: None
                    height: dp(54)
                    padding: [dp(12), 0,  dp(12), 0]
                    Text:
                        color: app.color_secondary_text
                        text: icon('icon-search')
                        font_size: sp(24)
                        size_hint_x: None
                        width: self.height
                        halign: 'center'
                        valign: 'middle'
                    SearchBar:
                        multiline: False
                        id : ti_search
                        hint_text: 'Serach by Product name'
                        on_text: self.keyboard_on()
                        suggetion_widget: Factory.FlatButton
                    
        BoxLayout:
            spacing: dp(12)
            orientation: 'vertical'
            padding: [0,0,dp(24), 0]
            BackBox:
                size_hint_y: None
                height: dp(48)
                bcolor: app.color_secondary_bg
                spacing: dp(12)
                padding: [dp(12), dp(2)]
                Text:
                    text: "Product Name"
                    font_name: app.fonts.heading
                    font_size: app.fonts.size.h3
                    color: app.color_primary_text
                    valign: 'middle'
                    size_hint_x: .4

                Text:
                    text: "Qty"
                    font_name: app.fonts.heading
                    font_size: app.fonts.size.h3
                    color: app.color_primary_text
                    valign: 'middle'
                    size_hint_x: .2
                    
                Text:
                    text: "Price"
                    font_name: app.fonts.heading
                    font_size: app.fonts.size.h3
                    color: app.color_primary_text
                    valign: 'middle'
                    
                    size_hint_x: .2 
            BoxLayout:   
                ScrollView:
                    do_scroll: [False, True]
                    size_hint_y: None
                    height: self.parent.height
                    GridLayout:
                        
                        id: container
                        cols: 1
                        spacing: dp(12)
                        size_hint_y: None
                        height: self.minimum_height
	BackBox:
        orientation:'vertical'

        size_hint_x: .3
        bcolor: app.color_alternate
        spacing: dp(12)
        padding: [dp(16),0,0,0]
        BoxLayout: 
            size_hint_y: None
            height: dp(64)
            spacing: dp(12)
            Text:

                text: icon('icon-bell')
                color: app.color_primary_text
                font_size:app.fonts.size.h1
                size_hint_x: None
                width:self.height
            Widget:
            BoxLayout:
                RelativeLayout:
                    Text:
                        text: icon("icon-chevron-down")
                        color: app.color_primary_text
                        font_size: app.fonts.size.h2
                        halign: 'right'

                    BoxLayout:
                        padding: [0,0,dp(24),0]
                        Spinner:
                            text: "frist.sam"
                            font_name: app.fonts.styled
                            color: app.color_primary_text
                            font_size: app.fonts.size.h3
                            bcolor: None
                            text_size: self.size
                            halign: 'right'
                            valign: "middle"
                            values: ['Profile', 'Logout']
                            background_normal: ""
                            background_down: ""
                            background_color: [0,0,0,0]
        Drivider:
            id: br
        BoxLayout:
            orientation: 'vertical'
            spacing: dp(8)
            BoxLayout: 
                size_hint_y: None
                height:dp(20)
                Text:
                    text: "Current Cart"
                    color: app.color_primary
                    font_size: app.fonts.size.h3
                    halign: 'center'
            BoxLayout:
                orientation: 'vertical'
                spacing: dp(8)
                padding: dp(12)
                BoxLayout:
                    id: header_box
                    size_hint_y: None
                    height: dp(24)
                    spacing: dp(4)
                    Text:
                        text: "Product Name"
                        color: app.color_primary_text
                        font_size: app.fonts.size.h3
                        halign: 'left'
                        size_hint_x: .5 
                    Text:
                        text: "Qty"
                        color: app.color_primary_text
                        font_size: app.fonts.size.h3
                        halign: 'center'
                        size_hint_x: .25

                    Text:
                        text: "Price"
                        color: app.color_primary_text
                        font_size: app.fonts.size.h3
                        size_hint_x: .3
                        halign: 'right'
                    
                Drivider:
                BoxLayout:
                    ScrollView:
                        do_scroll: [False, True]
                        size_hint_y: None
                        height: self.parent.height
                        GridLayout:
                            
                            id: gl_receipt
                            cols: 1
                            spacing: dp(12)
                            size_hint_y: None
                            height: self.minimum_height
                            
        Drivider:
            id: br
        BoxLayout:
            size_hint_y: None
            height:dp(54)*2
            orientation: 'vertical'
            spacing: dp(8)
            padding: [dp(12), 0]
            BoxLayout:
                spacing: sp(12)
                
                Text:
                    text: " Total"

                    font_name: app.fonts.heading
                    font_size: app.fonts.size.h2
                    color: app.color_primary_text
                    halign: "left"

                Text:
                    text: "$ %s"%str(root.current_total)

                    font_name: app.fonts.heading
                    font_size: app.fonts.size.h2
                    color: app.color_primary_text
                    halign: "right"
            RoundedButton:
                text:'print Receipt'
                font_name: app.fonts.heading
                font_size: app.fonts.size.h2
                color: rgba('#ffffff')
                radius: [self.height*.1]
                bcolor: app.color_primary

<Drivider@Widget>:
    size_hint_y: None   
    height: dp(1.2)
    canvas.before:
        Color:
            rgba: rgba('#dedede') 
        Rectangle:
            pos:self.pos
            size: self.size
<ProductTile>:
    on_release: root.add(root.id,True)
    size_hint_y: None
    height: dp(42)
    spacing: dp(8)
    padding: dp(12)
    canvas.before:
        Color:
            rgba: rgba(0,0,0,0)
        Rectangle:
            pos: self.pos
            size: self.size
    Text:
        text: root.name
        color: app.color_primary_text
        font_size: app.fonts.size.h4
        font_name: app.fonts.body
        size_hint_x: .4
    Text:
        text: str(root.qty)
        color: app.color_primary_text
        font_size: app.fonts.size.h4
        font_name: app.fonts.body
        size_hint_x: .15

    Text:
        text: '$'+str(root.price)
        color: app.color_primary_text
        font_size: app.fonts.size.h4
        font_name: app.fonts.body
        size_hint_x: .19

<ReceiptItem>:

    size_hint_y: None
    height: dp(24)
    spacing: dp(4)
    Text:
        text: root.name
        font_name: app.fonts.body
        color: app.color_primary_text
        font_size: app.fonts.size.h4
        halign: 'left'
        size_hint_x: .5 
    BackBox: 

        size_hint_x: .3
        FlatButton:
            text: icon('icon-minus-circle')
            font_size: app.fonts.size.h1    
            color: app.color_tertiary
            on_release: root.qty_callback(root, False) if root.qty_callback else print
            halgin: 'left'

        Text:
            text: "%s"%str(root.qty)
            font_name: app.fonts.body
            color: app.color_primary_text
            font_size: app.fonts.size.h5
            halign: 'center'
        FlatButton:
            text: icon('icon-plus-circle')
            font_size: app.fonts.size.h1    
            color: app.color_secondary
            halgin: 'right'
            on_release: root.qty_callback(root, True) if root.qty_callback else print
    
    Text:
        text: str(root.price * root.qty)
        font_name: app.fonts.body
        color: app.color_primary_text
        font_size: app.fonts.size.h4
        size_hint_x: .25
        halign: 'right'
    FlatButton:
        text: icon('icon-trash-2')
        font_size: app.fonts.size.h1    
        color: app.color_tertiary
        size_hint_x: .1
        
        on_release: root.deli(root) if root.qty_callback else print
